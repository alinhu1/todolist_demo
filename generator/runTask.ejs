import { PrismaClient } from "@zenstackhq/runtime";
import { Prisma } from "@zenstackhq/runtime/models";

export type TaskType =
<% actions.forEach(function(action){ %>
  <% models.forEach(function(model){ %>
  | {
      type: "<%= capitalize(model) %>/<%= capitalize(action) %>",
      value: Prisma.<%= capitalize(model) %><%= capitalize(action) %>Args,
    }
  <% }); %>
<% }); %>

export async function runTask(
  prisma: PrismaClient,
  task: TaskType,
): Promise<void> {
  const { type, value } = task;
  switch (type) {
    <% actions.forEach(function(action){ %>
      <% models.forEach(function(model){ %>
        case "<%= capitalize(model) %>/<%= capitalize(action) %>":
          await prisma.<%= camelCase(model) %>.<%= camelCase(action) %>(value);
          break;
      <% }); %>
    <% }); %>
    default:
      break;
  }
  return;
}
